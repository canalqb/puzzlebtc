meios = [
"'0000000000000000000000000000000000000000000000000000000000000001",
"'0000000000000000000000000000000000000000000000000000000000000003",
"'0000000000000000000000000000000000000000000000000000000000000007",
"'0000000000000000000000000000000000000000000000000000000000000008",
"'0000000000000000000000000000000000000000000000000000000000000015",
"'0000000000000000000000000000000000000000000000000000000000000031",
"'000000000000000000000000000000000000000000000000000000000000004c",
"'00000000000000000000000000000000000000000000000000000000000000e0",
"'00000000000000000000000000000000000000000000000000000000000001d3",
"'0000000000000000000000000000000000000000000000000000000000000202",
"'0000000000000000000000000000000000000000000000000000000000000483",
"'0000000000000000000000000000000000000000000000000000000000000a7b",
"'0000000000000000000000000000000000000000000000000000000000001460",
"'0000000000000000000000000000000000000000000000000000000000002930",
"'00000000000000000000000000000000000000000000000000000000000068f3",
"'000000000000000000000000000000000000000000000000000000000000c936",
"'000000000000000000000000000000000000000000000000000000000001764f",
"'000000000000000000000000000000000000000000000000000000000003080d",
"'000000000000000000000000000000000000000000000000000000000005749f",
"'00000000000000000000000000000000000000000000000000000000000d2c55",
"'00000000000000000000000000000000000000000000000000000000001ba534",
"'00000000000000000000000000000000000000000000000000000000002de40f",
"0000000000000000000000000000000000000000000000000000000000556e52",
"'0000000000000000000000000000000000000000000000000000000000dc2a04",
"'0000000000000000000000000000000000000000000000000000000001fa5ee5",
"'000000000000000000000000000000000000000000000000000000000340326e",
"'0000000000000000000000000000000000000000000000000000000006ac3875",
"'000000000000000000000000000000000000000000000000000000000d916ce8",
"'0000000000000000000000000000000000000000000000000000000017e2551e",
"'000000000000000000000000000000000000000000000000000000003d94cd64",
"'000000000000000000000000000000000000000000000000000000007d4fe747",
"'00000000000000000000000000000000000000000000000000000000b862a62e",
"'00000000000000000000000000000000000000000000000000000001a96ca8d8",
"'000000000000000000000000000000000000000000000000000000034a65911d",
"'00000000000000000000000000000000000000000000000000000004aed21170",
"'00000000000000000000000000000000000000000000000000000009de820a7c",
"'0000000000000000000000000000000000000000000000000000001757756a93",
"'00000000000000000000000000000000000000000000000000000022382facd0",
"'0000000000000000000000000000000000000000000000000000004b5f8303e9",
"'000000000000000000000000000000000000000000000000000000e9ae4933d6",
"'00000000000000000000000000000000000000000000000000000153869acc5b",
"'000000000000000000000000000000000000000000000000000002a221c58d8f",
"'000000000000000000000000000000000000000000000000000006bd3b27c591",
"'00000000000000000000000000000000000000000000000000000e02b35a358f",
"'0000000000000000000000000000000000000000000000000000122fca143c05",
"'00000000000000000000000000000000000000000000000000002ec18388d544",
"'00000000000000000000000000000000000000000000000000006cd610b53cba",
"'0000000000000000000000000000000000000000000000000000ade6d7ce3b9b",
"'000000000000000000000000000000000000000000000000000174176b015f4d",
"'00000000000000000000000000000000000000000000000000022bd43c2e9354",
"'00000000000000000000000000000000000000000000000000075070a1a009d4",
"'000000000000000000000000000000000000000000000000000efae164cb9e3c",
"'00000000000000000000000000000000000000000000000000180788e47e326c",
"'00000000000000000000000000000000000000000000000000236fb6d5ad1f43",
"'000000000000000000000000000000000000000000000000006abe1f9b67e114",
"'000000000000000000000000000000000000000000000000009d18b63ac4ffdf",
"'00000000000000000000000000000000000000000000000001eb25c90795d61c",
"'00000000000000000000000000000000000000000000000002c675b852189a21",
"'00000000000000000000000000000000000000000000000007496cbb87cab44f",
"'0000000000000000000000000000000000000000000000000fc07a1825367bbe",
"'00000000000000000000000000000000000000000000000013c96a3742f64906",
"'000000000000000000000000000000000000000000000000363d541eb611abee",
"'0000000000000000000000000000000000000000000000007cce5efdaccf6808",
"'000000000000000000000000000000000000000000000000f7051f27b09112d4",
"'000000000000000000000000000000000000000000000001a838b13505b26867",
"'000000000000000000000000000000000000000000000002832ed74f2b5e35ee",
"'00000000000000000000000000000000000000000000000730fc235c1942c1ae",
"'00000000000000000000000000000000000000000000000bebb3940cd0fc1491",
"'0000000000000000000000000000000000000000000000101d83275fb2bc7e0c",
"'0000000000000000000000000000000000000000000000349b84b6431a6c4ef1",
None,
None,
None,
None,
"'0000000000000000000000000000000000000000000004c5ce114686a1336e07",
None,
None,
None,
None,
"'00000000000000000000000000000000000000000000ea1a5c66dcc11b5ad180",
None,
None,
None,
None,
"'00000000000000000000000000000000000000000011720c4f018d51b8cebba8",
None,
None,
None,
None,
"'000000000000000000000000000000000000000002ce00bb2136a445c71e85bf",
None,
None,
None,
None,
"'0000000000000000000000000000000000000000527a792b183c7f64a0e8b1f4",
None,
None,
None,
None,
"'000000000000000000000000000000000000000af55fc59c335c8ec67ed24826",
None,
None,
None,
None,
"'000000000000000000000000000000000000016f14fc2054cd87ee6396b33df3",
None,
None,
None,
None,
"'00000000000000000000000000000000000035c0d7234df7deb0f20cf7062444",
None,
None,
None,
None,
"'0000000000000000000000000000000000060f4d11574f5deee49961d9609ac6",
None,
None,
None,
None,
"'0000000000000000000000000000000000b10f22572c497a836ea187f2e1fc23",
None,
None,
None,
None,
"'000000000000000000000000000000001c533b6bb7f0804e09960225e44877ac",
None,
None,
None,
None,
"'000000000000000000000000000000033e7665705359f04f28b88cf897c603c9",
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,
None,

]

import csv
from decimal import Decimal, getcontext

# Ajusta a precisão decimal (pode aumentar se precisar)
getcontext().prec = 50

# Dados fornecidos
ids = list(range(160))
powers_of_two = [2 ** i for i in range(1, 160)]

def hex_to_decimal(meio_str):
    if meio_str is None:
        return 0
    meio_str = meio_str.lstrip("'")
    try:
        return int(meio_str, 16)
    except ValueError:
        return 0

# Supondo que 'meios' seja uma lista externa que você já tenha definida,
# com os valores hexadecimais correspondentes aos IDs.
# Se não tiver, substitua 'meios' por sua lista real antes de rodar.

with open("Tabela_Corrigida.csv", "w", newline="", encoding="utf-8") as csvfile:
    writer = csv.writer(csvfile, delimiter=';')

    # Escreve cabeçalho
    header = [
        "'ID",
        "'Inicio(2^ID)",
        "'Meio(decimal)",
        "'2^(ID+1)-1"
    ] + [f"'{p}" for p in powers_of_two]
    writer.writerow(header)

    for id_val, meio_val in zip(ids, meios):
        inicio = Decimal(2) ** id_val
        fim = (Decimal(2) ** (id_val + 1)) - 1
        meio_decimal = Decimal(hex_to_decimal(meio_val))

        row = [
            f"'{id_val}",
            f"'{inicio}",
            f"'{meio_decimal}",
            f"'{fim}"
        ]

        for p in powers_of_two:
            p_dec = Decimal(p)
            valor = inicio / ((p_dec + meio_decimal) * 2) / Decimal(256) 

            # Checa se é inteiro (sem parte decimal)
            if valor == valor.to_integral():
                valor_str = f"'{int(valor)}"
            else:
                # Representa com até 50 casas decimais e vírgula decimal
                valor_str = f"'{format(valor, 'f').replace('.', ',')}"
                # Remove zeros à direita e vírgula final se houver
                valor_str = valor_str.rstrip('0').rstrip(',')
                # Garante pelo menos uma casa decimal
                if valor_str[-1] == ',':
                    valor_str += '0'

            row.append(valor_str)

        writer.writerow(row)

print("✅ Arquivo 'Tabela_Corrigida.csv' criado com os cálculos corretos e valores não científicos!")
